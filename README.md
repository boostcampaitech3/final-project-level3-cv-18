## ğŸ˜Š í”¼ë¶€ í‰ê°€ (XAI) ì‹œìŠ¤í…œ

&nbsp; 
## ğŸ”¥ Member ğŸ”¥
<table>
  <tr height="125px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515"><img src="https://avatars.githubusercontent.com/kimkihoon0515"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu"><img src="https://avatars.githubusercontent.com/ed-kyu"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo"><img src="https://avatars.githubusercontent.com/GwonPyo"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946"><img src="https://avatars.githubusercontent.com/ysw2946"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551"><img src="https://avatars.githubusercontent.com/jsh0551"/></a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771"><img src="https://avatars.githubusercontent.com/YJ0522771"/></a>
    </td>

  </tr>
  <tr height="70px">
    <td align="center" width="120px">
      <a href="https://github.com/kimkihoon0515">ê¹€ê¸°í›ˆ_T3019</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ed-kyu">ê¹€ìŠ¹ê·œ_T3037</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/GwonPyo">ë‚¨ê¶Œí‘œ_T3072</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/ysw2946">ìœ ìŠ¹ìš°_T3130</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/jsh0551">ì¥ìˆ˜í˜¸_T3185</a>
    </td>
    <td align="center" width="120px">
      <a href="https://github.com/YJ0522771">ì¡°ìœ ì§„_T3208</a>
    </td>
  </tr>
</table>

&nbsp; 

## ğŸ”Project Overview

## ğŸ‘©â€ğŸ«ê°œë°œ í™˜ê²½
- GPUí™˜ê²½ : V100 ì„œë²„, Google Cloud Platform(GCP) ì„œë²„
- íŒ€ í˜‘ë ¥ Tools : Notion, Weights&Biases, Github, Google Drive, MLflow
- ê°œë°œ Tools : VScode, Jupyter Lab
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° í”„ë ˆì„ì›Œí¬ : PyTorch, Streamlit

## ğŸ—‚ï¸Dataset

- í”¼ë¶€ë¥¼ ìœ ë¶„, ìˆ˜ë¶„, ì£¼ë¦„, ìƒ‰ì†Œ, ë¯¼ê°ë„ 5ê°€ì§€ í•­ëª©ìœ¼ë¡œ ë‚˜ëˆ„ê³ , ì •ë„ì— ë”°ë¼ 0ë¶€í„° 4ê¹Œì§€ í‰ê°€í•œ í”¼ë¶€ ë°ì´í„°![data](.\readme_file\data.jpg)
- ê° í•­ëª©ì˜ ì¼ë¶€ ë¼ë²¨ì´ ë§¤ìš° ë¶€ì¡±í•œ imbalance data
- ë³´ì•ˆ ê·œì • ìƒ í”¼ë¶€ ì´ë¯¸ì§€, ë°ì´í„° ìˆ˜, ë¼ë²¨ë§ ê¸°ì¤€ ë“±ì€ ê³µê°œ ë¶ˆê°€

## ğŸ‘¨â€ğŸ«í‰ê°€ Metric

- Penalty Recall

<img src="C:.\readme_file\precall.jpg" alt="precall" style="zoom:80%;" />

- Ordinal dataì´ê¸° ë•Œë¬¸ì— ì •ë‹µë§Œ ë§ì¶”ëŠ” ê²ƒ ë¿ ì•„ë‹ˆë¼ ì •ë‹µê³¼ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•˜ê²Œ ì˜ˆì¸¡í–ˆëŠ”ì§€ë„ ì¤‘ìš”í•¨
- ì •ë‹µê³¼ ì¸ì ‘í•œ ë¼ë²¨ë¡œ ì˜ˆì¸¡í•˜ë©´ ì¼ì • ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•œ ì •ë‹µìœ¼ë¡œ ì¸ì •í•˜ê³ , ì •ë‹µê³¼ ë¨¼ ë¼ë²¨ë¡œ ì˜ˆì¸¡í•˜ë©´ íŒ¨ë„í‹°ë¥¼ ì£¼ì–´ recallì„ ê³„ì‚°

## ğŸ§±Structure

![structure](.\readme_file\structure.jpg)

* Frontend
  * Userì˜ IDì™€ passwordë¥¼ ì…ë ¥í•˜ë©´ ê°œì¸ í”¼ë¶€ ì‚¬ì§„ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŒ
  * ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ë©´ í”¼ë¶€ í‰ê°€ ì ìˆ˜ì™€ gradcamì„ ì œê³µ
  * í‰ê°€ ì ìˆ˜ê°€ ì €ì¥ë˜ì–´ í”¼ë¶€ ë³€í™” ì¶”ì´ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸ ê°€ëŠ¥
* Backend
  * FastAPIë¡œ ëª¨ë¸ ì„œë²„ë¥¼ êµ¬ì¶•í•˜ì—¬ í‰ê°€ ì ìˆ˜ì™€ gradcamì„ ë¹ ë¥´ê²Œ ê³„ì‚°í•˜ì—¬ ì œê³µ
  * SQLiteë¡œ ì‚¬ìš©ìë“¤ì˜ ë°ì´í„° ì •ë³´ë¥¼ ì €ì¥

## ğŸ§ªExperiments

- Model

  |                  | Parameters | Metric           | Training Time |
  | ---------------- | ---------- | ---------------- | ------------- |
  | Swin V2          | 88M        | P-Recall: 0.5331 | 13m 45s       |
  | Swin Transformer | 28.3M      | P-Recall:0.5822  | 16m 01s       |
  | Twin             | 43.8M      | P-Recall: 0.5435 | 13m 37s       |
  | EfficientNet-B4  | 19M        | P-Recall: 0.4084 | 9m 56s        |
  | EfficientNet-B0  | 5.3M       | P-Recall: 0.5002 | 5m 4s         |

  ì„œë¹„ìŠ¤ë¥¼ í•˜ê¸° ìœ„í•´ ëª¨ë¸ì˜ ì„±ëŠ¥ ë¿ ì•„ë‹ˆë¼ ì†ë„ì™€ í¬ê¸°ë„ ê³ ë ¤í•˜ì—¬ EfficientNet-B0ë¡œ ìµœì¢… ê²°ì •

- Loss

  |      | Cross Entropy                        | label Smoothing CE                                       | Focal                                                        | Class Balanced Softmax CE                                | Class Balanced Focal                                     |
  | ---- | ------------------------------------ | -------------------------------------------------------- | ------------------------------------------------------------ | -------------------------------------------------------- | -------------------------------------------------------- |
  |      | ë‹¤ì¤‘ ë¶„ë¥˜ë¥¼ ìœ„í•œ ì†ì‹¤ í•¨ìˆ˜(Baseline) | Soft targetìœ¼ë¡œ ë°”ê¾¸ì–´ ì •ë‹µê³¼ ì˜¤ë‹µê°„ì˜ score ê²©ì°¨ë¥¼ ì¤„ì„ | ì–´ë µê±°ë‚˜ ì‰½ê²Œ ì˜¤ë¶„ë¥˜ë˜ëŠ” ì¼€ì´ìŠ¤ì— ë” í° ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì–´ ë¶ˆê· í˜• ë¬¸ì œë¥¼ ê°œì„  | ìƒˆë¡œìš´ ì¼€ì´ìŠ¤ë¥¼ í•™ìŠµí•  ë•Œ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì–´ ë¶ˆê· í˜• ë¬¸ì œ ê°œì„  | ìƒˆë¡œìš´ ì¼€ì´ìŠ¤ë¥¼ í•™ìŠµí•  ë•Œ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì–´ ë¶ˆê· í˜• ë¬¸ì œ ê°œì„  |

  <img src=".\readme_file\loss3.jpg" alt="loss3" style="zoom:67%;" />

  <img src=".\readme_file\loss4.jpg" alt="loss4" style="zoom:67%;" />

  <img src=".\readme_file\loss5.jpg" alt="loss5" style="zoom:67%;" />

  <img src=".\readme_file\loss1.jpg" alt="loss1" style="zoom:67%;" />

  <img src=".\readme_file\loss2.jpg" alt="loss2" style="zoom:67%;" />

  ê° í•­ëª© ë³„ ê°€ì¥ ë†’ì€ P-Recallì„ ë‹¬ì„±í•œ loss fuctionì„ ì‚¬ìš©

- Imbalanced Data Sampler

  ![sampler](.\readme_file\sampler.jpg)

  ë¹„ìœ¨ì´ ë†’ì€ ë¼ë²¨ì€ undersampling, ë¹„ìœ¨ì´ ë‚®ì€ ë¼ë²¨ì€ oversamplingí•˜ì—¬ í•™ìŠµ

  |      | Oil                                    | Wrinkle                                | Sensitive                              | Pigmentation | Hydration |
  | ---- | -------------------------------------- | -------------------------------------- | -------------------------------------- | ------------ | --------- |
  |      | 0.5879                                 | 0.4113                                 | 0.456                                  | 0.6934       | 0.4902    |
  |      | <span style="color:blue">0.6207</span> | <span style="color:blue">0.4177</span> | <span style="color:blue">0.5551</span> | 0.6856       | 0.4701    |

  Oil,Wrinkle,Sensitiveì˜ ê²½ìš° P-Recallì´ ì¦ê°€

  <span style="color:blue">

  </span>

- Augmentation

  |                              | Oil                                    | Wrinkle                                | Sensitive                              | Pigmentation                           | Hydration                              |
  | ---------------------------- | -------------------------------------- | -------------------------------------- | -------------------------------------- | -------------------------------------- | -------------------------------------- |
  | Resize(512,512)(Baseline)    | 0.5879                                 | 0.4113                                 | 0.2158                                 | 0.6934                                 | 0.4908                                 |
  | Resize(1024,1024)            | 0.7552                                 | 0.3800                                 | <span style="color:blue">0.6682</span> | <span style="color:blue">0.8018</span> | 0.2022                                 |
  | CenterCrop(512,512)          | 0.6286                                 | 0.2765                                 | 0.2557                                 | 0.6671                                 | 0.4686                                 |
  | RandomCrop(512,512)          | 0.7516                                 | <span style="color:blue">0.4480</span> | 0.4257                                 | <span style="color:blue">0.7460</span> | 0.4745                                 |
  | RandomResizedCrop(512,512)   | 0.6580                                 | 0.3283                                 | 0.2549                                 | 0.7324                                 | <span style="color:blue">0.5125</span> |
  | RandomResizedCrop(1024,1024) | <span style="color:blue">0.7631</span> | 0.4213                                 | 0.6149                                 | 0.7803                                 | 0.2181                                 |

  |                   | Oil                                    | Wrinkle | Sensitive                              | Pigmentation                           | Hydration                              |
  | ----------------- | -------------------------------------- | ------- | -------------------------------------- | -------------------------------------- | -------------------------------------- |
  | RGBShift          | <span style="color:blue">0.6197</span> | 0.3171  | 0.2142                                 | <span style="color:blue">0.7078</span> | <span style="color:blue">0.5035</span> |
  | ISONoise          | <span style="color:blue">0.6416</span> | 0.3524  | <span style="color:blue">0.2517</span> | 0.6920                                 | 0.4390                                 |
  | OpticalDistortion | <span style="color:blue">0.6441</span> | 0.3613  | 0.2081                                 | <span style="color:blue">0.7151</span> | 0.4653                                 |
  | RandomBrightness  | <span style="color:blue">0.6115</span> | 0.3696  | 0.2114                                 | 0.6904                                 | 0.4637                                 |
  | HorizontalFlip    | <span style="color:blue">0.6516</span> | 0.3642  | <span style="color:blue">0.2199</span> | 0.6768                                 | 0.3491                                 |

  Augmentation ì‹¤í—˜ì€ ë‹¤ìŒ ë‘ ê°€ì§€ ê´€ì ì—ì„œ ì§„í–‰

  1) ì£¼ì–´ì§„ ë°ì´í„°ë“¤ì˜ í¬ê¸°ì™€ ì¢…íš¡ë¹„ê°€ ë‹¤ë¥´ë¯€ë¡œ í•´ìƒë„ì™€ ë¹„ìœ¨ì— ëŒ€í•œ ì˜í–¥ì„ ì‹¤í—˜
  2) í”¼ë¶€ë¥¼ ì´¬ì˜í•˜ëŠ” í™˜ê²½ ì°¨ì´ë¥¼ ê³ ë ¤í•œ ì‹¤í—˜

  

  

## ğŸ†Result

- baseline -> ìµœì¢… ëª¨ë¸

![result2](.\readme_file\result2.jpg)

- ì‹œì—° ì˜ìƒ

https://www.youtube.com/watch?v=My0J8PAtfeI&t=1s
